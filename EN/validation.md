---
layout:
  width: wide
  title:
    visible: true
  description:
    visible: true
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
  metadata:
    visible: true
---

# Validate Data

{% columns %}
{% column %}
<figure><img src=".gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>
{% endcolumn %}

{% column %}
When managing master data, it's common to impose constraints on the data.

NonNonSheet enables quick detection of problematic data through cell-level data validation.


{% endcolumn %}
{% endcolumns %}



{% columns %}
{% column %}
```csharp
[NonNonTable]
public partial class SampleTable : NonNonTable<SampleData>, ISampleTableValidator { }

[Serializable]
public class SampleData
{
    public int Id;
    public string Name;
}
```
{% endcolumn %}

{% column %}
To perform validation, you must implement the IXxxValidator interface in the Table class.


{% endcolumn %}
{% endcolumns %}



{% columns %}
{% column %}
```csharp
public interface ISampleTableValidator : IValidator<SampleData>
{
    ValidationResult ValidateId(SubclassData self, int id) => ValidationResult.Success();
    ValidationResult ValidateName(SubclassData self, string id) => ValidationResult.Success();
}
```
{% endcolumn %}

{% column %}
The IXxxValidator interface is automatically generated by SourceGenerator.\
For example, when you define a class like SampleTable, the corresponding ISampleTableValidator interface will be generated.

The IXxxValidator interface defines validation methods for each field contained in the Table class.\
Implementing these methods allows you to perform data validation.

The validation method receives the entire data object to be validated and the updated field values as arguments. It also returns a ValidationResult object to indicate the outcome of the validation process.


{% endcolumn %}
{% endcolumns %}



## Validation Examples

{% columns %}
{% column %}
```csharp
[NonNonTable]
public partial class ValidationSampleTable : NonNonTable<ValidationSampleData>, IValidationSampleTableValidator
{
    ValidationResult IValidationSampleTableValidator.ValidateId(ValidationSampleData self, int id)
    {
        var sameIdData = Data.Where(v => v != self && v.Id == id).Cast<object>().ToArray();
        if (sameIdData.Any()) return ValidationResult.Error("duplicate ID", sameIdData);
        return ValidationResult.Success();
    }

    ValidationResult IValidationSampleTableValidator.ValidateName(ValidationSampleData self, string v)
    {
        if (string.IsNullOrEmpty(v)) return ValidationResult.Error("name must be non-empty");
        return ValidationResult.Success();
    }
}

[Serializable]
public class ValidationSampleData
{
    public int Id;
    public string Name;
}
```
{% endcolumn %}

{% column %}
ValidationExamples of several variations using the ValidationSampleTable.


{% endcolumn %}
{% endcolumns %}



{% columns fullWidth="true" %}
{% column %}
```csharp
ValidationResult IValidationSampleTableValidator.ValidateName(ValidationSampleData self, string v)
{
    if (string.IsNullOrEmpty(v)) return ValidationResult.Error("name must be non-empty");
    return ValidationResult.Success();
}
```


{% endcolumn %}

{% column %}
Let's start with a simple variation example.

ValidateName is a validation method that triggers an error when the Name field is empty.

Returns ValidationResult.Error in case of failure. You can pass a message as an argument to ValidationResult.Error to display it as the tooltip for the cell.

<div align="left"><figure><img src=".gitbook/assets/image (11).png" alt=""><figcaption></figcaption></figure></div>
{% endcolumn %}
{% endcolumns %}



{% columns fullWidth="true" %}
{% column %}
```csharp
ValidationResult IValidationSampleTableValidator.ValidateId(ValidationSampleData self, int id)
{
    var sameIdData = Data.Where(v => v != self && v.Id == id).Cast<object>().ToArray();
    if (sameIdData.Any()) return ValidationResult.Error("duplicate ID", sameIdData);
    return ValidationResult.Success();
}
```
{% endcolumn %}

{% column %}
Here's an example of validation for duplicate check.

The ValidateId method performs validation and returns an error if duplicate IDs are found in the data.

The Table class stores all data in its Data property. You can validate for duplicates by comparing each data item with its Id.

You can mark these duplicates as errors by passing them as the second argument to ValidationResult.Error.
{% endcolumn %}
{% endcolumns %}







